generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  EMPLOYEE
  TEAM_LEAD
  HR
  ADMIN
}

enum BookingType {
  KOMMEN
  GEHEN
  PAUSE_START
  PAUSE_ENDE
}

enum BookingSource {
  WEB
  APP
  TERMINAL
}

enum LeaveStatus {
  REQUESTED
  APPROVED
  DECLINED
}

enum LeaveType {
  VACATION
  SICKNESS
  SPECIAL
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  name      String
  role      Role
  createdAt DateTime @default(now())
  employee  Employee?
}

model Employee {
  id               Int           @id @default(autoincrement())
  personnelNumber  String        @unique
  name             String
  email            String
  location         String
  department       String
  workScheduleId   Int
  startDate        DateTime
  endDate          DateTime?
  role             Role
  userId           Int?
  user             User?         @relation(fields: [userId], references: [id])
  workSchedule     WorkSchedule  @relation(fields: [workScheduleId], references: [id])
  timeEntries      TimeEntry[]
  leaveRequests    LeaveRequest[]
}

model WorkSchedule {
  id        Int       @id @default(autoincrement())
  name      String
  monHours  Float
  tueHours  Float
  wedHours  Float
  thuHours  Float
  friHours  Float
  satHours  Float
  sunHours  Float
  breakRule String?
  employees Employee[]
}

model TimeEntry {
  id           Int           @id @default(autoincrement())
  employee     Employee      @relation(fields: [employeeId], references: [id])
  employeeId   Int
  timestampUtc DateTime
  type         BookingType
  source       BookingSource
  latitude     Float?
  longitude    Float?
}

model LeaveRequest {
  id          Int         @id @default(autoincrement())
  employee    Employee    @relation(fields: [employeeId], references: [id])
  employeeId  Int
  startDate   DateTime
  endDate     DateTime
  leaveType   LeaveType
  status      LeaveStatus @default(REQUESTED)
  comment     String?
  reviewedBy  Int?
  createdAt   DateTime    @default(now())
}
